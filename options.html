<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Settings</title>
    <link rel="stylesheet" href="options-styles.css">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <script src="options.js" defer></script>
</head>
<body class="flex items-center justify-center bg-gray-100" style="min-width: 400px">
<div class="m-6 p-6 bg-white rounded-lg shadow-md mx-auto " style="min-width: 350px">
    <form>
        <fieldset>
            <legend class="text-sm/6 font-semibold text-gray-900">Hacker News Companion Settings</legend>
            <p class="mt-1 text-sm/6 text-gray-600">Select the LLM provider for summarization.</p>

            <div class="mt-6 space-y-6">

                <div class="relative">
                    <div class="absolute inset-0 flex items-center" aria-hidden="true">
                        <div class="w-full border-t border-gray-300"></div>
                    </div>
                    <div class="relative flex justify-center">
                        <span class="bg-white px-2 text-sm text-gray-500">Local LLMs (Free)</span>
                    </div>
                </div>

                <!-- Ollama -->
                <div class="space-y-3">
                    <div class="flex items-center">
                        <input id="ollama" name="provider-selection" type="radio"
                               class="relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden [&:not(:checked)]:before:hidden">
                        <label for="ollama" class="ml-3 block text-sm font-medium text-gray-900">Ollama</label>


                        <details class="ml-2 inline-block relative">
                            <summary class="list-none text-gray-400 hover:text-gray-500 cursor-pointer">
                                <svg class="size-5 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 3.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM7.293 5.293a1 1 0 1 1 .99 1.667c-.459.134-1.033.566-1.033 1.29v.25a.75.75 0 1 0 1.5 0v-.115a2.5 2.5 0 1 0-2.518-4.153.75.75 0 1 0 1.061 1.06Z" clip-rule="evenodd" />
                                </svg>
                            </summary>
                            <div class="absolute left-0 -translate-x-32  mt-2 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-10 p-4 text-sm text-gray-600">
                                <p class="font-medium mb-2">ðŸ’¡ Free local summarization using Ollama</p>

                                <p class="mb-3">For this extension to work with Ollama:</p>

                                <ol class="list-decimal ml-4 space-y-2">
                                    <li>Make sure Ollama is running to see your downloaded models in the dropdown</li>
                                    <li>Enable CORS for the extension:
                                        <div class="mt-2 p-2 bg-gray-50 rounded font-mono text-xs">
                                            <p class="mb-1">On Mac (run on terminal):</p>
                                            <code class="bg-gray-100 px-2 py-1 rounded block overflow-x-auto">
                                                launchctl setenv OLLAMA_ORIGINS "chrome-extension://*,https://news.ycombinator.com"
                                            </code>
                                        </div>
                                        <div class="mt-2 p-2 bg-gray-50 rounded font-mono text-xs">
                                            <p class="mb-1">On Windows:</p>
                                            <code class="bg-gray-100 px-2 py-1 rounded block overflow-x-auto">
                                                setx OLLAMA_ORIGINS "chrome-extension://*,https://news.ycombinator.com"
                                            </code>
                                        </div>
                                    </li>
                                    <li>Restart Ollama for the CORS settings to take effect</li>
                                </ol>

                                <p class="mt-3 text-xs text-gray-500">Note: The model dropdown will automatically show your locally downloaded models when Ollama is running properly.
                                    Make sure the settings persist across machine restarts.</p>
                            </div>
                        </details>

                    </div>
                    <div class="ml-7 space-y-3">
                        <div>
                            <label for="ollama-model" class="block text-sm font-medium text-gray-900">Select Ollama Model</label>
                            <div class="mt-2 grid grid-cols-1">
                                <select id="ollama-model"
                                        name="ollama-model"
                                        class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 text-sm">
                                    <option value="llama2"></option>
                                </select>
                                <svg class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon">
                                    <path fill-rule="evenodd" d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!--Chrome Built-in AI-->
                <div class="space-y-3">
                    <div class="flex items-center ">
                        <input id="chrome-ai" name="provider-selection" type="radio"
                               class="relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden [&:not(:checked)]:before:hidden">
                        <label for="chrome-ai" class="ml-3 block text-sm font-medium text-gray-900">Chrome Built-in AI</label>
                        <span class="inline-flex items-center rounded-md ml-3 bg-pink-50 px-2 py-1 text-xs font-medium text-pink-700 ring-1 ring-inset ring-pink-700/10 ">Experimental</span>


                        <details class="ml-2 inline-block relative">
                            <summary class="list-none text-gray-400 hover:text-gray-500 cursor-pointer">
                                <svg class="size-5 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 3.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM7.293 5.293a1 1 0 1 1 .99 1.667c-.459.134-1.033.566-1.033 1.29v.25a.75.75 0 1 0 1.5 0v-.115a2.5 2.5 0 1 0-2.518-4.153.75.75 0 1 0 1.061 1.06Z" clip-rule="evenodd" />
                                </svg>
                            </summary>
                            <div class="absolute right-0 -translate-x-1 mt-2 w-80 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-10 p-4 text-sm text-gray-600">
                                <p class="font-medium mb-2">ðŸ’¡ Free local summarization using Chrome's built-in AI</p>
                                <p class="mb-3">Requires a one-time model download and Chrome 131+</p>
                                <p class="font-medium mb-1">Setup instructions:</p>
                                <ol class="list-decimal ml-4 space-y-1">
                                    <li>Type <code class="bg-gray-100 px-1 rounded">chrome://flags</code> in address bar</li>
                                    <li>Search for "Summarization"</li>
                                    <li>Enable "Summarization API for Gemini Nano"</li>
                                    <li>Restart Chrome</li>
                                    <li>Ensure summarization works in <a class="underline" href="https://chrome.dev/web-ai-demos/summarization-api-playground/" target="_blank">Playground</a>.</li>
                                </ol>
                                <p class="mt-3 text-xs text-gray-500">ðŸ’¡ Best for shorter content: While free and convenient, Chrome's built-in AI (Gemini Nano) works best with individual comments or brief discussion threads.
                                    It may struggle and hallucinate with full comment pages due to model size limitations.</p>
                            </div>
                        </details>

                    </div>
                </div>

                <div class="relative">
                    <div class="absolute inset-0 flex items-center" aria-hidden="true">
                        <div class="w-full border-t border-gray-300"></div>
                    </div>
                    <div class="relative flex justify-center">
                        <span class="bg-white px-2 text-sm text-gray-500">Cloud based LLMs (API Key Required)</span>
                    </div>
                </div>

                <!-- Anthropic -->
                <div class="space-y-3">
                    <div class="flex items-center">
                        <input id="anthropic" name="provider-selection" type="radio"
                               class="relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden [&:not(:checked)]:before:hidden">
                        <label for="anthropic" class="ml-3 block text-sm font-medium text-gray-900">Anthropic</label>
                        <span class="inline-flex items-center rounded-md ml-3 bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20" title="Supports larger context">ðŸŒŸ Best performance ðŸŒŸ</span>
                    </div>
                    <div class="ml-7 space-y-3">
                        <div class="mt-2 grid grid-cols-1">
                            <label for="anthropic-key" class="sr-only">Enter Anthropic API Key</label>
                            <input type="password"
                                   id="anthropic-key"
                                   name="anthropic-key"
                                   class="col-start-1 row-start-1 block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 text-sm/6"
                                   placeholder="Enter Anthropic API Key">
                            <details class="col-start-1 row-start-1 justify-self-end self-center mr-3 inline-block relative">
                                <summary class="list-none text-gray-400 hover:text-gray-500 cursor-pointer">
                                    <svg class="size-5 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 3.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM7.293 5.293a1 1 0 1 1 .99 1.667c-.459.134-1.033.566-1.033 1.29v.25a.75.75 0 1 0 1.5 0v-.115a2.5 2.5 0 1 0-2.518-4.153.75.75 0 1 0 1.061 1.06Z" clip-rule="evenodd" />
                                    </svg>
                                </summary>
                                <div class="absolute right-0 mt-2 w-72 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-10 p-4 text-sm text-gray-600">
                                    ðŸ”‘ API key is securely stored in your browser's local storage and can sync across your devices with browser sync. The key is transmitted only to the selected LLM provider when making requests.
                                </div>
                            </details>
                        </div>
                        <div>
                            <label for="anthropic-model" class="block text-sm font-medium text-gray-900">Select Anthropic Model</label>
                            <div class="mt-2 grid grid-cols-1">
                                <select id="anthropic-model"
                                        name="anthropic-model"
                                        class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 text-sm">
                                    <option value="claude-3-5-sonnet-latest">Claude 3.5 Sonnet</option>
                                    <option value="claude-3-5-haiku-latest">Claude 3.5 Haiku</option>
                                    <option value="claude-3-opus-latest">Claude 3 Opus</option>
                                </select>
                                <svg class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon">
                                    <path fill-rule="evenodd" d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- OpenAI -->
                <div class="space-y-3">
                    <div class="flex items-center ">
                        <input id="openai" name="provider-selection" type="radio"
                               class="relative size-4 appearance-none rounded-full border border-gray-300 bg-white before:absolute before:inset-1 before:rounded-full before:bg-white checked:border-indigo-600 checked:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:border-gray-300 disabled:bg-gray-100 disabled:before:bg-gray-400 forced-colors:appearance-auto forced-colors:before:hidden [&:not(:checked)]:before:hidden">
                        <label for="openai" class="ml-3 block text-sm font-medium text-gray-900">OpenAI</label>
                    </div>
                    <div class="ml-7 space-y-3">
                        <div class="mt-2 grid grid-cols-1">
                            <label for="openai-key" class="sr-only">Enter OpenAI API Key</label>
                            <input type="password"
                                   id="openai-key"
                                   name="openai-key"
                                   placeholder="Enter OpenAI API Key"
                                   class="col-start-1 row-start-1 block w-full rounded-md bg-white px-3 py-1.5 text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 text-sm">
                            <details class="col-start-1 row-start-1 justify-self-end self-center mr-3 inline-block relative">
                                <summary class="list-none text-gray-400 hover:text-gray-500 cursor-pointer">
                                    <svg class="size-5 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0Zm-6 3.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM7.293 5.293a1 1 0 1 1 .99 1.667c-.459.134-1.033.566-1.033 1.29v.25a.75.75 0 1 0 1.5 0v-.115a2.5 2.5 0 1 0-2.518-4.153.75.75 0 1 0 1.061 1.06Z" clip-rule="evenodd" />
                                    </svg>
                                </summary>
                                <div class="absolute right-0 mt-2 w-72 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-10 p-4 text-sm text-gray-600">
                                    ðŸ”‘ API key is securely stored in your browser's local storage and can sync across your devices with browser sync. The key is transmitted only to the selected LLM provider when making requests.
                                </div>
                            </details>
                        </div>

                        <div>
                            <label for="openai-model" class="block text-sm font-medium text-gray-900">Select OpenAI Model</label>
                            <div class="mt-2 grid grid-cols-1">
                                <select id="openai-model" name="openai-model" class="col-start-1 row-start-1 w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-8  text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 text-sm">
                                    <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                </select>
                                <svg class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon">
                                    <path fill-rule="evenodd" d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                                </svg>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </fieldset>

        <div class="mt-6 flex items-center justify-end gap-x-6">
            <button type="button" class="text-sm font-semibold text-gray-900">Cancel</button>
            <button type="submit"
                    class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                Save
            </button>
        </div>
    </form>
</div>
</body>
</html>